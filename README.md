# üè• Booking API

A production-ready RESTful API for managing appointments and bookings between clients and professionals. Built with Go, PostgreSQL, following clean architecture and DDD principles.

---

## ‚ú® Features

### Core Features
- üîê **JWT Authentication** - Secure service-to-service authentication
- üë• **User Management** - Client and professional registration with role-based access
- üìÖ **Appointment System** - Complete booking lifecycle (create, confirm, cancel, complete)
- üïí **Availability Management** - Real-time availability checking with hourly time slots
- üö´ **Unavailable Periods** - Professionals can mark themselves as unavailable
- üìä **Status Management** - Comprehensive appointment status tracking
- üîç **Smart Filtering** - Filter appointments by status, date, and user type

### Architecture & Code Quality
- üèóÔ∏è **Clean Architecture** - Separation of concerns (Handlers ‚Üí Services ‚Üí Repository)
- üì¶ **Service Layer** - Business logic isolated from HTTP layer
- üóÑÔ∏è **Type-Safe Database** - SQLC for compile-time safe SQL queries
- üîÑ **Database Migrations** - Version-controlled schema changes with golang-migrate
- ‚ö° **Performance Optimized** - Connection pooling, efficient queries
- üõ°Ô∏è **Input Validation** - Comprehensive request validation
- üìù **Structured Logging** - zerolog with request IDs
- üê≥ **Containerized** - Docker & Docker Compose ready

### Production Ready
- üîí **Security** - JWT, bcrypt passwords, SQL injection prevention
- üìä **Observability** - Health checks, structured logs
- ‚öôÔ∏è **Configuration** - YAML-based config with environment override
- üöÄ **Deployment** - Kubernetes ready with Helm charts
- üìö **Well Documented** - Comprehensive API documentation

---

## üõ†Ô∏è Tech Stack

| Component | Technology |
|-----------|-----------|
| **Language** | Go 1.23+ |
| **Web Framework** | Gin |
| **Database** | PostgreSQL 16 |
| **Query Builder** | SQLC (type-safe code generation) |
| **Migrations** | golang-migrate |
| **Authentication** | JWT (golang-jwt/jwt/v5) |
| **Password Hashing** | bcrypt |
| **Configuration** | Viper |
| **Logging** | zerolog |
| **Containerization** | Docker & Docker Compose |

---

## üöÄ Quick Start

### Prerequisites
- Go 1.23+
- Docker & Docker Compose
- Make
- (Optional) PostgreSQL 16 for local development

### Local Development

#### 1. Clone and Setup
```bash
cd booking_api

# Copy example configuration
cp configs/server-config.yaml.example configs/server-config.yaml

# Update JWT secret in config (or via env var)
export JWT_SECRET="your-super-secret-key"
```

#### 2. Start Services
```bash
# Start PostgreSQL, pgAdmin, and API
make start

# This will:
# - Start PostgreSQL on port 5432
# - Start pgAdmin on port 8081
# - Run database migrations
# - Start API server on port 8080
```

#### 3. Verify Installation
```bash
# Check API health
curl http://localhost:8080/api/health

# Expected response:
# {"status":"healthy"}
```

### Alternative: Manual Setup

```bash
# Start only database
docker-compose up -d postgres

# Run migrations
make migrate-up

# Run API locally (without Docker)
go run cmd/main.go

# Or build and run
make build
./main
```

---

## üìö API Documentation

### Base URL
```
http://localhost:8080/api
```

### Authentication
All API endpoints require JWT authentication (except health check).

**Header:**
```
Authorization: Bearer <JWT_TOKEN>
```

The JWT token is generated by the booking_client service and includes:
- Service name
- Issued at timestamp
- Expiration timestamp

---

## üìã API Endpoints

### üè• Health Check

#### GET `/api/health`
Check API health status.

**No authentication required**

```bash
curl http://localhost:8080/api/health
```

**Response:**
```json
{
  "status": "healthy"
}
```

---

### üë§ Client Endpoints

#### 1. Register Client
**POST** `/api/clients/register`

Register a new client account.

**Request:**
```bash
curl -X POST "http://localhost:8080/api/clients/register" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -d '{
    "first_name": "John",
    "last_name": "Doe",
    "chat_id": 123456789,
    "phone_number": "+1234567890"
  }'
```

**Response:**
```json
{
  "id": "28c31a08-f740-440e-a161-6c8136478e2b",
  "first_name": "John",
  "last_name": "Doe",
  "chat_id": 123456789,
  "phone_number": "+1234567890",
  "created_at": "2024-01-15T10:00:00Z"
}
```

#### 2. Get Client Appointments
**GET** `/api/clients/{id}/appointments`

Get all future appointments for a client.

**Query Parameters:**
- `status` (optional): `pending` | `confirmed` | `cancelled` | `completed`
- `date` (optional): Filter by specific date (YYYY-MM-DD)

**Request:**
```bash
# All appointments
curl "http://localhost:8080/api/clients/28c31a08-f740-440e-a161-6c8136478e2b/appointments" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"

# Only confirmed appointments
curl "http://localhost:8080/api/clients/28c31a08-f740-440e-a161-6c8136478e2b/appointments?status=confirmed" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

**Response:**
```json
{
  "appointments": [
    {
      "id": "71a738d8-6695-4fa3-b68a-c58797801258",
      "professional_id": "7c065dd1-22b9-4bed-82e2-be973cb6ea47",
      "professional_name": "Dr. Smith",
      "start_time": "2024-01-20T10:00:00Z",
      "end_time": "2024-01-20T11:00:00Z",
      "status": "confirmed",
      "created_at": "2024-01-15T10:00:00Z"
    }
  ]
}
```

#### 3. Cancel Appointment (Client)
**PATCH** `/api/clients/{id}/appointments/{appointment_id}/cancel`

Cancel an appointment as a client.

**Request:**
```bash
curl -X PATCH "http://localhost:8080/api/clients/28c31a08-f740-440e-a161-6c8136478e2b/appointments/71a738d8-6695-4fa3-b68a-c58797801258/cancel" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -d '{
    "cancellation_reason": "Need to reschedule"
  }'
```

**Response:**
```json
{
  "id": "71a738d8-6695-4fa3-b68a-c58797801258",
  "status": "cancelled",
  "cancellation_reason": "Need to reschedule",
  "cancelled_by": "client",
  "updated_at": "2024-01-15T11:00:00Z"
}
```

---

### üë®‚Äç‚öïÔ∏è Professional Endpoints

#### 1. Get All Professionals
**GET** `/api/professionals`

Get a list of all professionals.

**Request:**
```bash
curl "http://localhost:8080/api/professionals" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

**Response:**
```json
{
  "professionals": [
    {
      "id": "7c065dd1-22b9-4bed-82e2-be973cb6ea47",
      "first_name": "John",
      "last_name": "Smith",
      "username": "dr_smith",
      "phone_number": "+1234567890"
    }
  ]
}
```

#### 2. Professional Sign In
**POST** `/api/professionals/sign_in`

Authenticate a professional user and update their chat_id.

**Request:**
```bash
curl -X POST "http://localhost:8080/api/professionals/sign_in" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -d '{
    "username": "dr_smith",
    "password": "password123",
    "chat_id": 987654321
  }'
```

**Response:**
```json
{
  "id": "7c065dd1-22b9-4bed-82e2-be973cb6ea47",
  "first_name": "John",
  "last_name": "Smith",
  "username": "dr_smith",
  "chat_id": 987654321
}
```

#### 3. Get Professional Appointments
**GET** `/api/professionals/{id}/appointments`

Get all future appointments for a professional.

**Query Parameters:**
- `status` (optional): `pending` | `confirmed` | `cancelled` | `completed`
- `date` (optional): Filter by specific date (YYYY-MM-DD)

**Request:**
```bash
# All appointments
curl "http://localhost:8080/api/professionals/7c065dd1-22b9-4bed-82e2-be973cb6ea47/appointments" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"

# Only pending appointments
curl "http://localhost:8080/api/professionals/7c065dd1-22b9-4bed-82e2-be973cb6ea47/appointments?status=pending" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

#### 4. Confirm Appointment
**PATCH** `/api/professionals/{id}/appointments/{appointment_id}/confirm`

Confirm a pending appointment.

**Request:**
```bash
curl -X PATCH "http://localhost:8080/api/professionals/7c065dd1-22b9-4bed-82e2-be973cb6ea47/appointments/71a738d8-6695-4fa3-b68a-c58797801258/confirm" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

**Response:**
```json
{
  "id": "71a738d8-6695-4fa3-b68a-c58797801258",
  "status": "confirmed",
  "updated_at": "2024-01-15T11:00:00Z"
}
```

#### 5. Cancel Appointment (Professional)
**PATCH** `/api/professionals/{id}/appointments/{appointment_id}/cancel`

Cancel an appointment as a professional.

**Request:**
```bash
curl -X PATCH "http://localhost:8080/api/professionals/7c065dd1-22b9-4bed-82e2-be973cb6ea47/appointments/71a738d8-6695-4fa3-b68a-c58797801258/cancel" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -d '{
    "cancellation_reason": "Emergency - need to reschedule"
  }'
```

#### 6. Create Unavailable Period
**POST** `/api/professionals/{id}/unavailable_appointments`

Mark a time period as unavailable (vacation, lunch break, etc.).

**Request:**
```bash
curl -X POST "http://localhost:8080/api/professionals/7c065dd1-22b9-4bed-82e2-be973cb6ea47/unavailable_appointments" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -d '{
    "start_at": "2024-01-20T09:00:00Z",
    "end_at": "2024-01-20T17:00:00Z",
    "description": "Conference attendance"
  }'
```

**Response:**
```json
{
  "id": "9f8e7d6c-5b4a-3c2d-1e0f-fedcba987654",
  "type": "unavailable",
  "start_time": "2024-01-20T09:00:00Z",
  "end_time": "2024-01-20T17:00:00Z",
  "description": "Conference attendance"
}
```

#### 7. Get Professional Availability
**GET** `/api/professionals/{id}/availability`

Get hourly availability slots for a specific date (5:00 AM - 11:00 PM).

**Query Parameters:**
- `date` (required): Date in YYYY-MM-DD format

**Request:**
```bash
curl "http://localhost:8080/api/professionals/7c065dd1-22b9-4bed-82e2-be973cb6ea47/availability?date=2024-01-15" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

**Response:**
```json
{
  "date": "2024-01-15",
  "professional_id": "7c065dd1-22b9-4bed-82e2-be973cb6ea47",
  "slots": [
    {
      "start_time": "2024-01-15T05:00:00Z",
      "end_time": "2024-01-15T06:00:00Z",
      "available": true
    },
    {
      "start_time": "2024-01-15T10:00:00Z",
      "end_time": "2024-01-15T11:00:00Z",
      "available": false,
      "type": "appointment",
      "reason": "Booked by client"
    },
    {
      "start_time": "2024-01-15T14:00:00Z",
      "end_time": "2024-01-15T15:00:00Z",
      "available": false,
      "type": "unavailable",
      "reason": "Lunch break"
    }
  ]
}
```

#### 8. Get Appointment Dates
**GET** `/api/professionals/{id}/appointments/dates`

Get distinct dates with confirmed appointments for a month (used for calendar display).

**Query Parameters:**
- `month` (required): Month in YYYY-MM format

**Request:**
```bash
curl "http://localhost:8080/api/professionals/7c065dd1-22b9-4bed-82e2-be973cb6ea47/appointments/dates?month=2024-01" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

**Response:**
```json
{
  "month": "2024-01",
  "dates": [
    "2024-01-15",
    "2024-01-16",
    "2024-01-22",
    "2024-01-28"
  ]
}
```

---

### üìÖ Appointment Endpoints

#### Create Appointment
**POST** `/api/appointments`

Create a new appointment between a client and professional.

**Request:**
```bash
curl -X POST "http://localhost:8080/api/appointments" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -d '{
    "client_id": "28c31a08-f740-440e-a161-6c8136478e2b",
    "professional_id": "7c065dd1-22b9-4bed-82e2-be973cb6ea47",
    "start_time": "2024-01-15T10:00:00Z",
    "end_time": "2024-01-15T11:00:00Z",
    "description": "Regular checkup"
  }'
```

**Response:**
```json
{
  "id": "71a738d8-6695-4fa3-b68a-c58797801258",
  "client_id": "28c31a08-f740-440e-a161-6c8136478e2b",
  "professional_id": "7c065dd1-22b9-4bed-82e2-be973cb6ea47",
  "start_time": "2024-01-15T10:00:00Z",
  "end_time": "2024-01-15T11:00:00Z",
  "status": "pending",
  "type": "appointment",
  "created_at": "2024-01-14T15:30:00Z"
}
```

---

## üóÑÔ∏è Database Schema

### Tables

#### Clients
```sql
CREATE TABLE clients (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    chat_id BIGINT UNIQUE,
    first_name VARCHAR(255) NOT NULL,
    last_name VARCHAR(255) NOT NULL,
    phone_number VARCHAR(20),
    created_by UUID,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

#### Professionals
```sql
CREATE TABLE professionals (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    chat_id BIGINT UNIQUE,
    first_name VARCHAR(255) NOT NULL,
    last_name VARCHAR(255) NOT NULL,
    username VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255),
    phone_number VARCHAR(20),
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

#### Appointments
```sql
CREATE TABLE appointments (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    type appointment_type NOT NULL,           -- 'appointment' or 'unavailable'
    client_id UUID REFERENCES clients(id),    -- NULL for unavailable periods
    professional_id UUID NOT NULL REFERENCES professionals(id),
    start_time TIMESTAMP WITH TIME ZONE NOT NULL,
    end_time TIMESTAMP WITH TIME ZONE NOT NULL,
    status appointment_status DEFAULT 'pending',
    description TEXT,
    cancellation_reason TEXT,
    cancelled_by_professional_id UUID REFERENCES professionals(id),
    cancelled_by_client_id UUID REFERENCES clients(id),
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

### Enums
```sql
CREATE TYPE appointment_type AS ENUM ('appointment', 'unavailable');
CREATE TYPE appointment_status AS ENUM ('pending', 'confirmed', 'cancelled', 'completed');
```

### Indexes
```sql
-- Performance indexes
CREATE INDEX idx_appointments_professional_time ON appointments(professional_id, start_time);
CREATE INDEX idx_appointments_client_time ON appointments(client_id, start_time);
CREATE INDEX idx_appointments_status ON appointments(status);
CREATE INDEX idx_clients_chat_id ON clients(chat_id);
CREATE INDEX idx_professionals_chat_id ON professionals(chat_id);
```

---

## üèóÔ∏è Architecture

### Clean Architecture Layers

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         HTTP Layer (Gin)                ‚îÇ
‚îÇ  - Handlers (Controllers)               ‚îÇ
‚îÇ  - Middleware (Auth, Logging)           ‚îÇ
‚îÇ  - Request/Response DTOs                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         Service Layer                   ‚îÇ
‚îÇ  - Business Logic                       ‚îÇ
‚îÇ  - Validation Rules                     ‚îÇ
‚îÇ  - Domain Models                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ      Repository Layer (SQLC)            ‚îÇ
‚îÇ  - Type-safe SQL queries                ‚îÇ
‚îÇ  - Database operations                  ‚îÇ
‚îÇ  - Transaction management               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         PostgreSQL Database             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Directory Structure

```
booking_api/
‚îú‚îÄ‚îÄ cmd/
‚îÇ   ‚îú‚îÄ‚îÄ main.go              # Application entry point
‚îÇ   ‚îî‚îÄ‚îÄ migrate/
‚îÇ       ‚îî‚îÄ‚îÄ main.go          # Migration tool
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ api/                 # HTTP layer
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ handlers.go      # Route registration
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ middleware/      # Auth, logging middleware
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ common/          # Shared HTTP utilities
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ clients/         # Client endpoints
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ professionals/   # Professional endpoints
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ appointments/    # Appointment endpoints
‚îÇ   ‚îú‚îÄ‚îÄ services/            # Business logic layer
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ clients/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ professionals/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ appointments/
‚îÇ   ‚îú‚îÄ‚îÄ repository/          # Data access layer (SQLC)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ queries/         # SQL query files
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ *.sql.go         # Generated code
‚îÇ   ‚îú‚îÄ‚îÄ database/            # DB connection
‚îÇ   ‚îú‚îÄ‚îÄ config/              # Configuration
‚îÇ   ‚îú‚îÄ‚îÄ token/               # JWT handling
‚îÇ   ‚îú‚îÄ‚îÄ migrations/          # SQL migrations
‚îÇ   ‚îî‚îÄ‚îÄ util/                # Utilities
‚îú‚îÄ‚îÄ pkg/
‚îÇ   ‚îî‚îÄ‚îÄ server/              # Server initialization
‚îú‚îÄ‚îÄ configs/
‚îÇ   ‚îî‚îÄ‚îÄ server-config.yaml   # Configuration file
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ docker-compose.yml
‚îî‚îÄ‚îÄ Makefile
```

---

## ‚öôÔ∏è Configuration

### server-config.yaml

```yaml
server:
  host: 0.0.0.0
  port: 8080

database:
  host: postgres
  port: 5432
  user: booking_user
  password: booking_pass
  dbname: booking_db
  sslmode: disable
  max_connections: 25
  max_idle_connections: 10
  max_lifetime_seconds: 3600

jwt:
  secret: ${JWT_SECRET}  # Override with environment variable
```

### Environment Variables

```bash
# Database
DATABASE_URL=postgresql://user:pass@localhost:5432/booking_db

# JWT
JWT_SECRET=your-super-secret-key-change-in-production

# Server
SERVER_HOST=0.0.0.0
SERVER_PORT=8080

# Logging
LOG_LEVEL=info  # debug, info, warn, error
```

---

## üõ†Ô∏è Development

### Commands

```bash
# Start all services (Docker Compose)
make start

# Stop all services
make stop

# View logs
make logs

# Restart services
make restart

# Clean up everything
make clean

# Build binary
make build

# Run without Docker
make run
```

### Database Commands

```bash
# Connect to PostgreSQL shell
make db-shell

# Open pgAdmin (http://localhost:8081)
make pgadmin

# Run migrations up
make migrate-up

# Rollback last migration
make migrate-down

# Create new migration
make migrate-create NAME=add_new_feature

# Check migration version
make migrate-version
```

### SQLC Commands

```bash
# Generate type-safe code from SQL
make sqlc-generate

# Validate SQLC configuration
make sqlc-validate
```

### Testing

```bash
# Run all tests
go test ./...

# Run tests with coverage
go test -cover ./...

# Run tests verbosely
go test -v ./...

# Run specific package tests
go test ./internal/services/...
```

---

## üîí Security

### JWT Authentication
- All API endpoints require valid JWT token
- Token includes service name and expiration
- Shared secret between API and client
- Tokens expire after configurable duration

### Password Security
- Professional passwords hashed with bcrypt (cost factor 10)
- Never stored in plain text
- Compared using constant-time comparison

### Database Security
- Type-safe queries via SQLC (SQL injection prevention)
- Prepared statements
- Connection pooling
- UUID primary keys (security through obscurity)

### Input Validation
- All requests validated before processing
- UUID format validation
- Time range validation
- Business rule validation in service layer

---

## üìä Error Handling

### Standard Error Response

```json
{
  "error": {
    "type": "validation_error",
    "message": "Invalid input data",
    "details": "start_time must be in the future",
    "request_id": "550e8400-e29b-41d4-a716-446655440000"
  }
}
```

### Error Types

| Type | HTTP Status | Description |
|------|-------------|-------------|
| `validation_error` | 400 | Invalid input data |
| `unauthorized` | 401 | Missing or invalid JWT token |
| `forbidden` | 403 | Not allowed to access resource |
| `not_found` | 404 | Resource not found |
| `conflict` | 409 | Resource already exists or conflict |
| `internal_error` | 500 | Internal server error |
| `database_error` | 500 | Database operation failed |

---

## üìà Monitoring

### Health Check
```bash
curl http://localhost:8080/api/health
```

### Logs
Structured JSON logs with zerolog:
```json
{
  "level": "info",
  "request_id": "550e8400-e29b-41d4-a716-446655440000",
  "method": "POST",
  "path": "/api/appointments",
  "status": 201,
  "duration_ms": 45,
  "time": "2024-01-15T10:00:00Z",
  "message": "request completed"
}
```

### Metrics
- Request duration
- Status code distribution
- Database query performance
- Active connections

---

## üöÄ Deployment

### Docker

```bash
# Build image
docker build -t booking-api:latest .

# Run container
docker run -p 8080:8080 \
  -e DATABASE_URL="postgresql://..." \
  -e JWT_SECRET="..." \
  booking-api:latest
```

### Kubernetes

See [deployment documentation](../deployments/DEPLOYMENT_GUIDE.md) for:
- Helm charts
- ArgoCD setup
- Multi-environment deployment
- Secrets management

---

## üß™ API Testing

### Using cURL

```bash
# Get JWT token (from booking_client or generate manually)
TOKEN="your-jwt-token"

# Test health endpoint
curl http://localhost:8080/api/health

# Get professionals
curl -H "Authorization: Bearer $TOKEN" \
  http://localhost:8080/api/professionals

# Create appointment
curl -X POST http://localhost:8080/api/appointments \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "client_id": "uuid",
    "professional_id": "uuid",
    "start_time": "2024-01-20T10:00:00Z",
    "end_time": "2024-01-20T11:00:00Z"
  }'
```

### Using Postman

1. Import collection (create from API docs)
2. Set environment variable `JWT_TOKEN`
3. Add header: `Authorization: Bearer {{JWT_TOKEN}}`
4. Test endpoints

---

## ü§ù Contributing

1. Follow clean architecture principles
2. Add tests for new features
3. Update API documentation
4. Use conventional commit messages
5. Generate SQLC code after SQL changes
6. Run migrations for schema changes

---

## üìÑ License

[Your License Here]

---

**Built with ‚ù§Ô∏è and Go**
